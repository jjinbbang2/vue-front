name: Vue.js Code Quality Check

on:
  pull_request:
    paths:
      - 'src/**/*.vue'
      - 'src/**/*.js'
      - 'src/**/*.css'

jobs:
  vue-component-review:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Vue.js Component Structure Check
      run: |
        echo "ğŸ” Vue.js ì»´í¬ë„ŒíŠ¸ êµ¬ì¡° ê²€ì‚¬ ì‹œì‘..."
        
        # Composition API ì‚¬ìš© í™•ì¸
        echo "ğŸ“ Composition API ì‚¬ìš© í™•ì¸:"
        if find src/components -name "*.vue" -exec grep -l "script setup" {} \; | wc -l | grep -q "^0$"; then
          echo "âš ï¸  WARNING: <script setup> ì‚¬ìš©ì„ ê¶Œì¥í•©ë‹ˆë‹¤"
        else
          echo "âœ… Composition API ì‚¬ìš© í™•ì¸ë¨"
        fi
        
        # Scoped ìŠ¤íƒ€ì¼ í™•ì¸
        echo "ğŸ¨ Scoped ìŠ¤íƒ€ì¼ í™•ì¸:"
        if find src/components -name "*.vue" -exec grep -L "style scoped" {} \; | grep -q ".vue"; then
          echo "âš ï¸  WARNING: ë‹¤ìŒ ì»´í¬ë„ŒíŠ¸ì— scoped ìŠ¤íƒ€ì¼ì´ ëˆ„ë½ë¨:"
          find src/components -name "*.vue" -exec grep -L "style scoped" {} \;
        else
          echo "âœ… ëª¨ë“  ì»´í¬ë„ŒíŠ¸ì— scoped ìŠ¤íƒ€ì¼ ì ìš©ë¨"
        fi
        
        # ë°˜ì‘í˜• ë””ìì¸ í™•ì¸
        echo "ğŸ“± ë°˜ì‘í˜• ë””ìì¸ í™•ì¸:"
        if find src/components -name "*.vue" -exec grep -L "@media" {} \; | grep -q ".vue"; then
          echo "âš ï¸  INFO: ë‹¤ìŒ ì»´í¬ë„ŒíŠ¸ì— ë¯¸ë””ì–´ ì¿¼ë¦¬ ê³ ë ¤ í•„ìš”:"
          find src/components -name "*.vue" -exec grep -L "@media" {} \;
        else
          echo "âœ… ë°˜ì‘í˜• ë””ìì¸ ì ìš© í™•ì¸ë¨"
        fi
        
        # ìµœëŒ€ ë„ˆë¹„ 1200px í™•ì¸
        echo "ğŸ“ ì»¨í…Œì´ë„ˆ ìµœëŒ€ ë„ˆë¹„ í™•ì¸:"
        if grep -r "max-width.*1200px" src/components/ >/dev/null; then
          echo "âœ… 1200px ìµœëŒ€ ë„ˆë¹„ ì»¨í…Œì´ë„ˆ ì‚¬ìš© í™•ì¸ë¨"
        else
          echo "âš ï¸  INFO: 1200px ìµœëŒ€ ë„ˆë¹„ ì»¨í…Œì´ë„ˆ ì‚¬ìš© ê¶Œì¥"
        fi
        
        # ë„¤ì´ë° ê·œì¹™ í™•ì¸
        echo "ğŸ“ ë„¤ì´ë° ê·œì¹™ í™•ì¸:"
        for file in src/components/*.vue; do
          filename=$(basename "$file" .vue)
          if [[ $filename =~ ^[A-Z][a-zA-Z]*$ ]]; then
            echo "âœ… $filename: PascalCase ì¤€ìˆ˜"
          else
            echo "âš ï¸  WARNING: $filename: PascalCase ê¶Œì¥"
          fi
        done
        
        # Semantic HTML í™•ì¸
        echo "ğŸ·ï¸  Semantic HTML í™•ì¸:"
        if grep -r "div class.*container\|section\|article\|header\|footer\|nav\|main" src/components/ >/dev/null; then
          echo "âœ… Semantic HTML ìš”ì†Œ ì‚¬ìš© í™•ì¸ë¨"
        else
          echo "âš ï¸  INFO: Semantic HTML ìš”ì†Œ ì‚¬ìš© ê¶Œì¥"
        fi

  accessibility-check:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Accessibility Check
      run: |
        echo "â™¿ ì ‘ê·¼ì„± ê²€ì‚¬ ì‹œì‘..."
        
        # alt ì†ì„± í™•ì¸
        echo "ğŸ–¼ï¸  ì´ë¯¸ì§€ alt ì†ì„± í™•ì¸:"
        if grep -r "<img" src/components/ | grep -v "alt=" | wc -l | grep -q "^0$"; then
          echo "âœ… ëª¨ë“  ì´ë¯¸ì§€ì— alt ì†ì„± ì¡´ì¬"
        else
          echo "âš ï¸  WARNING: alt ì†ì„±ì´ ëˆ„ë½ëœ ì´ë¯¸ì§€ ë°œê²¬:"
          grep -r "<img" src/components/ | grep -v "alt="
        fi
        
        # ARIA ë ˆì´ë¸” ì‚¬ìš© í™•ì¸
        echo "ğŸ·ï¸  ARIA ë ˆì´ë¸” í™•ì¸:"
        if grep -r "aria-" src/components/ >/dev/null; then
          echo "âœ… ARIA ë ˆì´ë¸” ì‚¬ìš© í™•ì¸ë¨"
        else
          echo "ğŸ’¡ INFO: ë³µì¡í•œ UIì—ëŠ” ARIA ë ˆì´ë¸” ì¶”ê°€ ê³ ë ¤"
        fi
        
        # ìƒ‰ìƒ ëŒ€ë¹„ ê´€ë ¨ CSS í™•ì¸
        echo "ğŸ¨ ìƒ‰ìƒ ê´€ë ¨ ìŠ¤íƒ€ì¼ í™•ì¸:"
        if grep -r "color.*#" src/components/ >/dev/null; then
          echo "ğŸ’¡ INFO: ìƒ‰ìƒ ëŒ€ë¹„ ë¹„ìœ¨ í™•ì¸ ê¶Œì¥ (ìµœì†Œ 4.5:1)"
        fi

  performance-check:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Performance Analysis
      run: |
        echo "âš¡ ì„±ëŠ¥ ê´€ë ¨ ê²€ì‚¬ ì‹œì‘..."
        
        # í° ì´ë¯¸ì§€ URL í™•ì¸
        echo "ğŸ–¼ï¸  ì´ë¯¸ì§€ ìµœì í™” í™•ì¸:"
        if grep -r "unsplash.com.*w=1920" src/components/ >/dev/null; then
          echo "ğŸ’¡ INFO: ê³ í•´ìƒë„ ì´ë¯¸ì§€ ì‚¬ìš© ì¤‘ - WebP ë³€í™˜ ê³ ë ¤"
        fi
        
        # ë¶ˆí•„ìš”í•œ import í™•ì¸
        echo "ğŸ“¦ Import ìµœì í™” í™•ì¸:"
        if grep -r "import.*vue.*{.*}" src/components/ >/dev/null; then
          echo "âœ… í•„ìš”í•œ Vue ê¸°ëŠ¥ë§Œ import ì¤‘"
        fi
        
        # ì¸ë¼ì¸ ìŠ¤íƒ€ì¼ í™•ì¸
        echo "ğŸ¨ ì¸ë¼ì¸ ìŠ¤íƒ€ì¼ í™•ì¸:"
        if grep -r 'style="' src/components/ >/dev/null; then
          echo "âš ï¸  WARNING: ì¸ë¼ì¸ ìŠ¤íƒ€ì¼ ë°œê²¬ - CSS í´ë˜ìŠ¤ ì‚¬ìš© ê¶Œì¥:"
          grep -r 'style="' src/components/
        else
          echo "âœ… ì¸ë¼ì¸ ìŠ¤íƒ€ì¼ ë¯¸ì‚¬ìš©"
        fi
